<!DOCTYPE html>
<html>
	<head>
		<style type="text/css">
			* { margin: 0px; padding: 0px; }
			html, body { height: 100%; }

			body { background-color: #fff; }
			body.dark { background-color: #171717; }

			iframe { width: 100% !important; height: 100% !important; }
		</style>
	</head>
	<body>
		<script type="text/javascript">
			window.addEventListener('message', event => {
				if (event.origin.match('http://localhost:') || (event.origin === null)) {
					const body = document.body;
					const { html, js, theme, libs } = event.data;

					loadLibs(libs, () => {
						body.innerHTML = html;
						body.className = theme;

						if (js) {
							eval(js);
						};
					});
				};
			});

			function loadLibs (list, callBack) {
				const src = list.shift();
				const script = document.createElement('script');

				document.head.appendChild(script);

				script.onload = function (e) {
					console.log(e, src);

					if (list.length) {
						loadScripts(list, callBack);
					} else {
						console.log('run app');
						if (callBack) {
							callBack();
						};
					};
				};

				script.type = 'text/javascript';
				script.src = src;
			};
		</script>
	</body>
</html>